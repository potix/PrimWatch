LIBS = -L/usr/lib/x86_64-linux-gnu -L/opt/local/lib -L/usr/local/lib  -pthread -levent -lyajl
INCS =  -I. -I./dns -I./bson -I/usr/include/x86_64-linux-gnu -I/opt/local/include -I/usr/local/include
CFLAGS = -O2 -pipe -Wall -std=gnu99
DEBUG = -g3 -ggdb3
CC = gcc

ACCESSA_POWERDNS_PROG = primwatch_powerdns
ACCESSA_POWERDNS_SRCS = accessa_main.c lookup.c bhash.c shared_buffer.c bson_helper.c bson/bson.c bson/encoding.c bson/numbers.c logger.c dns/powerdns.c
ACCESSA_POWERDNS_OBJS = $(ACCESSA_POWERDNS_SRCS:%.c=%.o)
ACCESSA_POWERDNS_HEADERS = common_macro.h common_defile.h lookup.h bhash.h shared_buffer.h bson_helper.h bson/bson.h bson/encoding.h logger.h dns/powerdns.h record.h
ACCESSA_POWERDNS_CFLAGS = -DPOWERDNS

$(ACCESSA_POWERDNS_PROG): $(ACCESSA_POWERDNS_OBJS)
	$(CC) $(CFLAGS) -o $@ $(ACCESSA_POWERDNS_OBJS) $(LIBS)
.c.o: $(ACCESSA_POWERDNS_HEADERS)
	$(CC) $(CFLAGS) $(ACCESSA_POWERDNS_CFLAGS) $(INCS) $(DEBUG) -o $(patsubst %.c,%.o,$<) -c $<
clean:
	rm -rf *.o */*.o $(ACCESSA_POWERDNS_PROG)
